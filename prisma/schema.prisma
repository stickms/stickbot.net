generator client {
  provider = "prisma-client"
  output   = "../src/.generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model SyncUser {
  id          String @id @unique @default(uuid())
  username    String
  ownedRooms  SyncRoom[]
  messages    SyncMessage[]
  media       SyncMedia[]
}

model SyncRoom {
  id          String @id @unique
  name        String
  owner       SyncUser @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  ownerId     String
  queue       SyncMedia[]
  messages    SyncMessage[]
}

model SyncMessage {
  id          String @id @unique @default(uuid())
  content     String
  timestamp   DateTime @default(now())
  room        SyncRoom @relation(fields: [roomId], references: [id], onDelete: Cascade)
  roomId      String
  owner       SyncUser @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  ownerId     String   
}

model SyncMedia {
  id          String @id @unique @default(uuid())
  url         String
  title       String
  owner       SyncUser @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  ownerId     String
  syncRoom    SyncRoom @relation(fields: [roomId], references: [id], onDelete: Cascade)
  roomId      String
}
